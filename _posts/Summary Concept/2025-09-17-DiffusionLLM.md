---
title: "DiffusionLLM의 연구 동향"
date: 2025-09-17 17:02:43 +/-0000
categories: [Study]
tags: [LLM, DiffusionLLM]   
use_math: true  # TAG names should always be lowercase
---

# **Diffusion 기반 LLM: 구조, 특성 및 최신 연구 동향**



## **1. Diffusion 기반 언어모델의 구조와 작동 원리**





**Diffusion 모델의 개념:** Diffusion(확산) 모델은 *점진적 노이즈 제거* 과정을 통해 데이터를 생성하는 방식입니다. 처음에는 완전히 노이즈가 섞인 상태에서 시작하여 여러 단계에 걸쳐 노이즈를 제거함으로써 최종 샘플(텍스트 시퀀스)을 얻습니다  . 이 접근법은 이미지 생성 분야에서 먼저 성공을 거두었고, 이후 텍스트와 같은 이산 데이터에도 적용되고 있습니다 . **Diffusion 언어모델(DLM)**은 이러한 확산 과정을 언어 생성에 활용한 것으로, 언어 데이터를 점진적으로 복원하도록 학습됩니다 .



**연속 vs. 이산 확산:** 텍스트는 이산적(discrete)인 토큰으로 구성되므로, 확산 과정을 적용하는 방식에 따라 두 가지 접근이 있습니다. **(a) 연속 확산(continuous diffusion)**은 토큰을 임베딩 등의 연속 벡터 공간에 매핑하여 그 공간에서 확산 모델을 수행하는 방식입니다 . 예를 들어 *Diffusion-LM*은 단어 임베딩 공간에서 확산 모델을 학습한 초기 연구로, 확산 모델의 *역전파(reverse)* 과정을 통해 임베딩을 복원한 뒤 최종적으로 가장 가까운 단어 토큰으로 변환합니다  . 이러한 연속 확산 모델들은 최종 단계에서 복원된 임베딩을 이산 단어로 **반올림(mapping)**하는 단계가 필요한데, 임베딩 공간에서 가장 가까운 단어를 찾거나 디코더를 통해 해당 임베딩을 단어로 변환하는 방법이 활용됩니다  . 한편 **(b) 이산 확산(discrete diffusion)**은 임베딩으로 매핑하지 않고 직접 토큰 공간에서 확산을 정의합니다 . 예를 들어 *D3PM*은 이산 확률 전이 행렬을 사용하여 각 단계마다 토큰을 다른 토큰(또는 특수 마스크)으로 무작위 치환하는 방식으로 “노이즈 추가”를 수행하고, 역방향으로 토큰을 복원하는 확산 모델을 제시했습니다 . 이후 연구에서는 BERT와 같은 사전학습 마스크 모델을 결합하여 노이즈 제거 성능을 높이거나 , 토큰 출현 빈도에 따른 노이즈 스케줄(예: *spindle schedule*) 등을 도입하여 텍스트에 특화된 확산 방식을 개발하였습니다 . 이산 확산의 경우, 모델은 마스크된(혹은 손상된) 토큰 시퀀스를 입력으로 받아 원래의 문장을 복원하도록 학습됩니다 .



**Latent 확산 모델:** Latent diffusion은 이미지 분야에서 고해상도 생성을 위해 쓰이는 개념으로, 입력을 저차원의 잠재공간(latent space)으로 인코딩하여 그 공간에서 확산 과정을 수행한 후 다시 디코딩하는 방식입니다. 언어 영역에서도 유사하게 **압축된 잠재 표현**을 활용한 확산이 연구되고 있습니다. 예를 들어, *LD4LG*는 사전학습 언어모델을 **강력한 오토인코더**로 활용하여 텍스트를 압축된 잠재공간에 표현한 뒤, 그 공간에서 연속 확산을 수행하여 고품질 텍스트를 생성했습니다  . 또한 *LaDiffuSeq* 등은 별도의 인코더-디코더 구조를 도입해 문장을 저차원 벡터로 인코딩하고, 그 latent 벡터에 대해 확산 과정을 거친 후 디코더로 텍스트를 생성하는 방식을 취합니다  . 이러한 latent 접근은 직접 토큰 공간을 다루는 것보다 **연산 차원을 줄여 효율을 높이고**, 노이즈 추가/제거 과정에서 발생하는 **라운딩 오류** 등을 완화하는 데 도움이 됩니다  .



요약하면, Diffusion LLM은 **“문장을 부분적으로 망가뜨린 후 이를 복원하는”** 훈련을 거쳐, 생성 시에는 임의 노이즈 입력을 점차 의미 있는 텍스트로 바꾸는 과정을 수행합니다. 이때 연속 확산은 임베딩 등의 연속공간에서, 이산 확산은 토큰 자체에서 복원을 시도한다는 구조적 차이가 있습니다. 또한 latent 확산은 별도 압축공간을 활용하여 효율성과 제어력을 높이는 방법입니다.





## **2. Autoregressive LLM과 Diffusion LLM의 비교 (장점 및 단점)**





**생성 방식 차이:** Autoregressive(자기회귀) 언어모델은 GPT 시리즈처럼 *왼쪽에서 오른쪽으로* 순차적으로 다음 토큰을 예측하며 문장을 생성합니다 . 반면 Diffusion LLM은 *전체 시퀀스를 병렬로* 반복 보정하는 방식으로 문장을 만듭니다  . 즉, AR 모델은 이전까지의 모든 토큰에 의존해 한 토큰씩 내놓는 **단방향** 생성이고, Diffusion 모델은 매 스텝마다 **양방향 문맥**(앞뒤 문맥)을 활용해 전체 문장의 토큰들을 점진적으로 수정합니다  .



**속도 및 효율:** AR 모델은 길이가 $N$인 문장을 생성하려면 $N$번의 순차 추론 단계를 거쳐야 하므로 병렬화에 한계가 있습니다 . Diffusion LLM은 $T$번의 확산 스텝을 거치며 한 문장을 만들지만, 각 스텝에서 **전체 토큰을 병렬로 처리**할 수 있습니다 . 만약 필요한 스텝 수 $T$가 생성 길이 $N$보다 작거나 비슷한 수준이라면, GPU 등 병렬연산 환경에서 Diffusion LLM이 **잠재적으로 빠른 추론**을 달성할 수 있습니다 . 실제로 연구자들은 고속화를 위해 확산 단계를 줄이는 **단계 증류(step distillation)** 기법 등을 적용하여, 수백 단계의 확산을 1단계로 줄여도 품질을 유지하면서 **数배 이상의 속도 향상**을 보고하기도 했습니다 . 예컨대 *DLM-One*이라는 시도는 적대적 학습을 곁들인 스코어-기반 distillation로 단 한 번의 추론으로 문장을 생성하면서 교사 모델 품질에 근접하는 성능을 달성했다고 보고됩니다 . 또한 *Mercury Coder*와 같은 상용 Diffusion LLM은 코드 생성에서 고도로 최적화된 AR 모델 대비 **최대 10배 이상의 처리량**을 시현하여 화제가 되었습니다 . **다만**, 확산 모델은 기본적으로 다수의 반복 연산을 필요로 하기 때문에, 최적화가 충분하지 않은 경우 AR보다 느릴 수 있고, 특히 긴 문장 생성에서는 효율 저하가 발생할 수 있습니다. 이를 개선하기 위해 *토큰별 캐싱*, *고신뢰 토큰 조기 확정* 등 다양한 가속 기법들이 도입되고 있습니다  . 예를 들어 *Fast-dLLM*은 토큰 확률이 일정 임계값 이상인 토큰을 해당 확산 단계에서 확정(unmasking)하는 전략으로 **최대 27.6배** 속도 향상을 달성하면서도 품질 저하를 보이지 않았습니다 .



**텍스트 품질:** 전통적으로 AR LLM은 다음 토큰 예측을 직접 최적화하기에, 문법적으로 자연스러운 문장을 생성하고 퍽 높은 Perplexity 성능을 보여왔습니다. 초기 Diffusion LLM들은 품질 면에서 AR에 미치지 못했으나 , 최근 연구들은 대규모 데이터와 모델로 격차를 빠르게 줄였습니다. 예컨대 8억 규모의 *LLaDA-8B*는 유사 크기의 자기회귀 모델(LLaMA3-8B)과 거의 동등한 언어모델 성능(perplexity 등)을 보였으며 , 7억 규모 *Dream-7B* 모델은 일반적 자연어 이해, 수학 추론, 코드 생성 등 벤치마크에서 동급 AR 모델(Qwen 2.5 7B)을 **맞먹는 수준**으로 따라잡았습니다 . 특히 Dream-7B는 확산 모델 고유의 장점 덕분에 일부 **계획 및 추론 영역에서 AR보다 우수한 성과**를 보였다고 보고되었습니다 . 그럼에도 최고 수준의 거대 모델(예: GPT-4)에 비해서는 여전히 성능 격차가 존재하며, 여러 일반 분야 과제에서 AR 최첨단을 완전히 대체했다고 보기는 이릅니다  . 따라서 품질 측면에서 Diffusion LLM은 **“대등한 수준까지 도달했다”**는 평가와 함께, 남은 격차를 줄이기 위한 연구가 지속되고 있습니다.



**제어력 및 유연성:** Diffusion LLM의 큰 장점 중 하나는 **생성 제어력**입니다. 확산 모델은 중간 과정에 조건을 부여하거나 일정 부분을 고정하면서 생성하는 것이 자연스러운데, 예를 들어 *부분 편집*, *문장 삽입/보완*, *양식(스타일) 제어* 등이 용이합니다  . 이미지 확산 모델에서 흔히 쓰이는 **분류자-프리 가이드 (classifier-free guidance)** 기법 등을 텍스트에도 적용하여 문체나 내용 조건을 미세하게 조정할 수 있고  , 확산 과정 자체가 *마스크-재마스크(iterative masking)* 방식으로 구현되기 때문에 원하는 토큰은 초기부터 마스크하지 않고 고정한 채 나머지 부분만 생성하도록 하는 등 **부분적 생성**도 쉽게 구현됩니다  . 반면 AR 모델에서 특정 내용만 바꾸거나 중간에 삽입하려면, 일반적으로 추가적인 fine-tuning이나 복잡한 프롬프트 기법이 필요합니다. Diffusion LLM은 이러한 국지적 제어가 내재된 구조이므로, 사용자의 의도나 제약사항을 **세밀하게 반영**하는 데 유리합니다  . 예를 들어, *Diffusion-BERT* 연구에서는 마스크드 언어모델을 결합한 확산 모델로 문장의 특정 위치를 다양하게 생성하거나, 자주 등장하는 단어일수록 더 쉽게 마스크되도록 스케줄을 조정하여 **빈도 편향 제어**를 시연했습니다 . 이러한 **컨트롤 가능성**은 창의적 생성이나 사용자 맞춤 응용에서 Diffusion LLM의 강점으로 부각되고 있습니다.



**모델 및 맥락 확장성:** 자기회귀 LLM은 파라마터 규모를 수십억에서 수천억까지 키우며 성능을 향상시켜온 반면, Diffusion LLM은 2023년까지는 비교적 소규모(수억 파라미터) 수준에 머물렀습니다. 그러나 **최근 2024년경부터 수십억 규모 모델들이 등장**하며 확장성 검증이 이루어지고 있습니다 . 예컨대 LLaDA-8B (80억 파라미터)는 대용량 코퍼스(2.3조 토큰)로 처음부터 학습되어, 유사 크기의 AR 모델과 견줄 성능을 보임으로써 **규모 확장의 유효성**을 입증했습니다  . 또 하나의 측면은 **맥락 길이** 확장입니다. AR 모델은 문맥이 길어지면 순차적 처리가 더 길어지지만, Diffusion LLM은 전체 문장을 한꺼번에 다루기에 긴 문맥에서도 한번에 생성이 가능합니다. 다만 매우 긴 문서의 경우 확산 단계에서 메모리 부담 등이 있을 수 있어 연구가 필요한 영역입니다. 2024년 발표된 *LongLLaDA* 연구는 확산 LLM의 최대 맥락 길이를 늘리고자 한 첫 시도로, **학습한 길이 이상의 문맥도 안정적으로 처리**할 수 있음을 보였습니다 . 이 연구에 따르면 확산 LLM은 문맥 길이를 늘려도 Perplexity가 안정적으로 유지되고, 긴 대화에서 **정보 검색 능력이 AR보다 우수**할 수도 있다는 흥미로운 결과를 보고했습니다 . 또한 별도 재훈련 없이 포지셔널 임베딩(RoPE)의 외삽 특성을 활용하여 문맥 길이를 확장하는 기법으로 성능 향상을 달성, AR 모델에서 알려진 **스케일링 법칙이 확산 모델에도 유효**함을 확인했습니다 . 이러한 노력들은 Diffusion LLM이 **대규모 파라미터, 대용량 데이터, 장문 맥락** 등 여러 측면에서 확장 가능함을 보여주며, 향후 AR 모델의 한계를 극복할 잠재력을 시사합니다.



**요약:** Diffusion LLM은 AR LLM 대비 **병렬 생성과 양방향 문맥 활용**으로 **속도와 전역 코히어런스** 면에서 이점이 있고, **세밀한 제어와 편집 능력**을 선천적으로 지닙니다  . 품질 면에서는 빠르게 발전하여 AR에 근접하고 있으며, 일부 영역에서는 고유의 강점을 보입니다 . 반면, 여러 반복 계산으로 인한 **추론 비용**, 그리고 완전한 성능 동등성까지의 **격차**는 남은 과제입니다 . 그럼에도 불구하고 diffusion 패러다임은 AR 접근의 근본적 제약을 보완할 **유망한 대안**으로 부상하고 있습니다 .





## **3. 2024–2025년 주요 Diffusion LLM 연구 및 모델**





최근 2년간 Diffusion LLM 분야에서는 다양한 핵심 연구와 대규모 모델이 발표되었습니다. 아래에 대표적인 연구들과 그 특징을 정리합니다:



- **DiffuLLaMA (2023)** – *Shansan Gong 등*, 기존 AR 언어모델을 확산 모델로 **효율적으로 적응**(Adaptation)시킨 접근입니다. 오픈소스 LLM (예: GPT, LLaMA 시리즈)들의 사전학습 가중치를 초기화에 활용하여, 1억~70억 파라미터 범위의 확산 모델을 짧은 시간에 학습했고, 그 결과 AR 모델과 **비견하거나 우수한 성능**을 달성했습니다  . DiffuLLaMA는 AR 기반 지식을 활용함으로써 학습 비용을 절감하면서도 확산 모델固有의 **자유로운 위치 생성**(임의 위치 채움 등) 능력을 확보했다는 점에서 의의가 있습니다  .
- **LLaDA 8B (2025)** – *Shen Nie 등*, **Large Language Diffusion with mAsking**의 약자로, 약 80억 파라미터 규모 **최초의 완전한 사전학습 Diffusion LLM**입니다  . 토큰 마스킹을 활용한 확산(reverse) 과정과 Transformer 아키텍처를 결합하여, 사전학습(pre-training)과 지도 미세조정(SFT)을 거친 거대 확산 언어모델을 제작했습니다. 성능적으로 LLaDA 8B는 동등 규모의 최신 AR 모델인 *LLaMA3-8B*와 **인컨텍스트 학습 능력에서 대등한 수준**을 보였고, SFT를 거친 후에는 **지시 따르기(instruction-following)** 능력 역시 뛰어남을 확인했습니다 . 흥미롭게도, **문장 순서를 거꾸로 뒤집는** 등 AR 모델이 약한 태스크(역순 시, reversal curse)에서 GPT-4의 파생모델보다 높은 성과를 내며 확산 모델의 새로운 가능성을 시사했습니다 . 해당 연구는 Diffusion LLM이 대규모로도 효과적으로 학습될 수 있음을 보여주며, “AR만이 거대언어모델의 길”이라는 통념에 도전했습니다 .
- **Dream 7B (2025)** – *Jiacheng Ye et al.*, 홍콩대 NLP 그룹과 화웨이가 공동 개발한 70억 규모 **오픈소스 diffusion LLM**입니다. *Qwen-7B* (AR 모델)의 가중치로 초기화한 후 5,800억 토큰에 달하는 방대한 데이터로 추가 학습하여, 2025년 공개 당시 **가장 강력한 Diffusion LLM**으로 평가되었습니다 . Dream-7B는 기존 확산 모델들을 큰 폭으로 앞서는 성능을 보였을 뿐만 아니라, **동일 크기의 최첨단 AR 모델들과 어깨를 나란히하거나 뛰어넘는 성능**을 달성했습니다 . 예를 들어 일반 상식, 수학 문제 해결, 코딩 능력에서 *Qwen 2.5 (7B)*나 *LLaMA3-7B*와 비등하거나 우수한 결과를 보였고, 특히 **계획/추론(planning)** 능력에서 두각을 나타냈습니다  . 또한 확산 모델의 이점으로 **임의 순서 생성, 단계적 품질-속도 조정** 등의 **유연한 추론 전략**을 구현할 수 있어, 기존 AR 모델에 없는 활용성을 시연했습니다  . Dream 7B의 등장은 확산 LLM이 실제 AR 방식의 한계를 넘어설 수 있음을 증명한 사례로 평가됩니다.
- **Mercury Coder (2025)** – *Inception Labs*, 코드 생성에 특화된 **상용 Diffusion LLM**입니다. 정확한 파라미터는 공개되지 않았으나 약 70억 규모로 알려져 있으며, 대량의 코드 데이터(수조 토큰)를 학습했습니다 . Mercury Coder의 가장 큰 특징은 **압도적인 생성 속도**로, 고도로 최적화된 AR 코드생성 모델보다 **최대 10배 빠른** 토큰 출력을 달성하면서도 주요 코딩 벤치마크에서 **유사한 답변 품질**을 유지했습니다 . 이는 병렬 생성의 이점을 극한까지 활용한 사례로서, 실용 면에서 Diffusion LLM이 **상업적 응용 가능성**을 입증한 사례로 평가됩니다 . 해당 모델의 성공은 코드 도메인처럼 정형화된 언어에서는 확산 모델이 특히 강점을 보일 수 있음을 시사합니다.
- **Diffusion-of-Thought (2024)** – *Jiacheng Ye 등*, 확산 LLM에 **Chain-of-Thought(연쇄 사고)** 기법을 통합한 연구입니다. AR 모델은 논리 추론시 토큰을 한 순서대로 내뱉지만, Diffusion-of-Thought(DoT)는 **여러 단계의 추론 과정을 확산 모델상에서 병렬적·점진적으로 전개**하도록 설계되었습니다 . 이를 통해 추가 계산 시간과 성능 간의 유연한 트레이드오프를 조절할 수 있고, 복잡한 문제를 단계별로 해결하면서 **자기 교정(self-correction)** 능력을 보였습니다  . 실험 결과 다자리 수 곱셈, 불 논리, 산술 문제 등에서 DoT가 AR 모델 대비 향상된 **추론 정확도**를 달성했고, 확산 모델의 **자연스러운 오류 수정 과정**을 통해 일관성 있는 답을 얻을 수 있음을 보여주었습니다  . 이는 확산 LLM이 단순 텍스트 생성뿐만 아니라 **복잡한 추론 영역에서도 경쟁력**을 가질 수 있음을 부각시킨 연구입니다.





이외에도 **Hybrid AR-Diffusion 모델**(예: *BD3-LM* )처럼 두 가지 접근의 장점을 절충하려는 시도, **멀티모달 확산 LLM**(예: *LLaDA-V*, *Dimple* 등 )처럼 텍스트-이미지 등을 동시에 다루는 모델, **장문 맥락 특화** 모델(*LongLLaDA*)  등 다양한 방향의 연구가 활발히 진행되고 있습니다. 이러한 최신 연구들은 Diffusion LLM 패러다임의 **성능 향상과 범용화** 가능성을 지속적으로 확장해나가고 있으며, 확산 기반 언어모델이 앞으로 NLP 분야에서 차세대 주류 중 하나로 부상할 수 있다는 전망을 뒷받침합니다.





## **추가 Question**

### **여기서 긴 시퀀스의 텍스트를 생성할때 부담이 늘어난다는 한계를 극복한 모델**

- **LongLLaDA**: NTK-기반 RoPE 스케일링으로 **무학습(long-context) 확장**. 24k 토큰까지 실험, 안정적 perplexity·부분 검색 유지. 
- **Fast-dLLM (NVLabs)**: **KV 캐시 + 신뢰도 기반 병렬 디코딩**. Dream·LLaDA에서 **최대 27.6×** 처리량 향상. 
- **dKV-Cache**: **지연(delayed) KV-캐시**로 확산 단계 간 재사용. **2–10× 가속**, 긴 시퀀스에서도 품질 유지 혹은 개선 보고. 
- **dLLM-Cache**: **적응형 캐싱(프롬프트 장기 캐시+부분 응답 갱신)**. **최대 9.1× 가속**, AR에 근접한 지연. 
- **FreeCache + Guided Diffusion**: **KV 근사 캐시**와 **AR 보조 가이드**로 **최대 34× 가속**, 긴 프롬프트·롱컨텍스트에서 지연 대폭 감소. 



### **여러 문장이 있는 문단 자체를 생성할때에는 각 문장에 대해 따로따로 diffusion을 적용?**

아니. 기본은 **문단 전체 시퀀스에 병렬 확산**을 돌려 한 번에(여러 스텝 동안) 토큰들을 공동으로 정제한다. 문장별로 따로 돌리는 방식은 예외다.



실제 생성 방식 요약:



- **전체 마스크/노이즈 → 전역 복원**: 길이 N 토큰을 동시에 갱신.
- **점진적 언마스킹**: 신뢰도 높은 토큰부터 확정하며 남은 토큰만 반복 복원.
- **블록/슬라이딩 윈도우**: 긴 문맥은 겹치는 구간 단위로 생성·재정제.
- **계층형(플랜→실현)**: 개요·스케치(잠재/키워드)를 먼저 확산으로 만들고 문장 채움.



문장 단위 확산은 편집·국소 수정엔 쓰일 수 있으나, 문단 생성의 기본 전략은 **전역 공동 정제**다.



### **문단을 여러개 생성할 때, 이전 문단 내용에 이어지는 다음 문단을 생성해야하잖아? 이전 문단의 문맥을 어떻게 고려해?**

1. 전역 확산

   - 문서 전체를 하나의 시퀀스로 놓고 **이전 문단은 고정**, 다음 문단 토큰만 **마스크 해제·정제**.

   - **양방향 self-attention**으로 다음 문단이 앞 문단 토큰을 모두 참조.
   - Model
     - **LLaDA (LLaDA 8B)**: 마스킹→언마스킹 확산으로 한 스텝마다 모든 마스크 토큰을 병렬 복원. 임의 위치 인필·부분 고정이 자연스럽다. 장점: 전역 문맥 일관성, 위치 자유도. 한계: 전 시퀀스 반복 연산으로 지연 큼. 
     - **Dream-7B**: 이산 확산으로 병렬 정제, 임의 순서 생성·인필 지원. 계획·추론 태스크 강점 보고. 장점: 유연한 생성 전략. 한계: 대규모 학습·추론 비용. 

2. 창·블록 생성

   - **슬라이딩 윈도우**로 단락 묶음을 생성. 이전 블록의 **오버랩 구간을 유지**해 문맥 전파.

   - 완료 블록은 **락**하고, 새 블록만 반복 복원.
   - Model
     - **BD3-LMs**: 시퀀스를 블록으로 분해해 블록 내 이산 확산. AR과 확산 사이를 보간하며 임의 길이 생성 지원. 장점: 고정 길이 제약 완화, 우수한 likelihood. 한계: 여전히 캐시 재사용 취약, AR 대비 품질 격차 보고. 
     - **EB-Sampler 등 MDM 가속**: 병렬 언마스킹에서 중복 연산을 줄이는 적응형 샘플러. 장점: 스텝·연산 감소. 한계: 설계가 샘플링 휴리스틱에 민감. 

3. 조건 신호 추가

   - **개요/키워드 잠재 z_{plan}**를 먼저 생성 후 각 문단 확산의 **조건**으로 사용.

   - 이전 문단을 **요약 임베딩**(encoder)으로 압축해 **크로스-어텐션 컨디션**으로 공급.

   - **엔티티·타임라인 테이블**을 외부 메모리로 넣어 일관성 강제.
   - Model
     - **PLANNER**: 문단 잠재(계획)를 확산으로 생성 후 AR 디코더로 정교화. 장점: 전역 제어력과 유창성 병행. 한계: 하이브리드로 복잡도↑, 완전 비자기회귀 아님. 
     - **Diffusion-LM(NeurIPS’22)**: 연속 잠재 확산+그라디언트 가이던스로 세밀 제어(PnP). 장점: 속성·문체 등 플러그인 제어. 한계: 외부 분류기·스코어 의존, 속도 손실. 
     - **Latent Diffusion for Language**: 강한 오토인코더로 텍스트를 잠재로 압축 후 확산. 장점: 효율·제어 용이. 한계: 디코더 품질·재구성 오차에 민감. 

4. 길이/안정화 기술

   - **조기 언마스킹**(신뢰 높은 토큰 확정), **KV-캐시 재사용**, **RoPE/NTK 스케일링**으로 긴 문맥 유지.

   - **경계 토큰**(, 섹션 태그)과 **세그먼트 임베딩**으로 단락 연결 제어.
   - Model
     - **LongLLaDA**: NTK-기반 RoPE 외삽으로 학습 없이 롱컨텍스트 확장. 장점: 퍼플렉시티 안정, 최근 구간 검색 강함. 한계: 장거리 전역 회상은 제한. 
     - **Fast-dLLM (NVLabs)**: 블록형 근사 **KV-캐시** + 병렬 디코딩. 최대 수배 가속 보고. 장점: 훈련 없이 속도↑. 한계: 근사로 품질 저하 가능, 설정 민감. 
     - **dKV-Cache**: 지연형 KV-캐시로 스텝간 재사용. 2–10× 가속, 긴 시퀀스에서 품질 개선 사례. 한계: 공격적 캐싱 변형은 품질 손실. 
     - **dLLM-Cache**: 장기 프롬프트 캐시+부분 응답 갱신의 적응형 캐싱. 최대 9.1× 가속. 한계: 구현 복잡, 모델별 튜닝 필요. 
     - **FreeCache + Guided Diffusion**: 근사 캐시와 AR-가이드로 최대 34× 속도. 한계: AR 보조 의존, 시스템 복잡도↑. 



요약: 이전 문단은 고정·조건으로 쓰고, 다음 문단은 그 위에서 병렬 확산으로 정제한다. 창 오버랩·요약 컨디션·계획 잠재로 연결성을 강화한다.



<details><summary>How about this</summary>

<div markdown="1">
  **Diffusion LLM 블록 생성 접근에 대한 분석**







## **개요: 블록 단위 Diffusion LLM의 아이디어**





사용자가 제안한 방식은 **Diffusion 기반 언어 모델**(LLM)로 긴 텍스트를 생성할 때 **여러 문장을 하나의 블록으로 묶어** 동시에 생성하고, 각 블록 간에는 **요약 토큰**을 통해 문맥을 전달하는 **반(半)자기회귀 블록 생성** 방법입니다. 구체적으로, 한 블록에 N개의 문장을 포함시키고 이 블록을 Diffusion 과정으로 한꺼번에 생성하며, 블록 내 **[CLS]와 유사한 특수 토큰**을 추가하여 블록 전체의 **전역 문맥**을 표현합니다. 이 특수 토큰은 블록의 뒷부분(후반 문장들)에 더 큰 가중치를 주어 해당 블록의 **주요 맥락과 흐름**을 함축하도록 설계됩니다. 그런 다음 다음 블록을 생성할 때 이전 블록들의 특수 토큰들을 조건으로 활용하여 앞서 생성된 내용과 **일관성 있는 이어지는 텍스트**를 생성합니다. 요약하면, **각 블록은 Diffusion 모델로 병렬 생성**하되 블록들 간에는 **자기회귀적(autoregressive)으로 연결**하여 GPT처럼 **토큰 단위**가 아닌 **블록 단위로 순차 생성**하는 개념입니다.



이 방법은 한 블록 내부에서는 **양방향 문맥(bidirectional context)**을 활용한 생성이 가능하고, 블록 간에는 **이전 블록들의 요약 정보만 활용**하므로 전체 문맥 길이를 줄여 효율을 높일 수 있다는 점에서 기존 GPT의 완전 좌→우 방향 **토큰별 생성**과 차별화됩니다.





## **관련 연구 동향 및 유사 접근 사례**





제안된 아이디어와 유사한 방향의 연구들이 최근 활발히 진행되고 있습니다. 특히 **확산 모델을 언어 모델링에 적용**하면서 **완전 병렬 생성과 순차 생성의 장점을 결합**하려는 시도가 늘어나고 있습니다:



- **SSD-LM (Han et al., 2023)**: 확산 기반 **반자기회귀 언어 모델**로, 한 번에 일정 **블록의 토큰들을 생성**하고 다음 블록으로 넘어가는 방식을 도입했습니다. 블록 내에서는 **양방향 컨텍스트**로 토큰들을 갱신하므로 문맥 활용이 자유롭고, 블록 단위로 좌→우 순차 진행하여 출력 길이의 유연성을 확보했습니다 . SSD-LM은 이러한 블록 생성 방식으로 **GPT-2 수준의 기존 autoregressive 모델에 필적하거나 뛰어난 텍스트 생성 품질**을 보였으며 , 확산 모델 특유의 **병렬 생성**과 **제어 용이성**도 활용한 사례입니다.
- **Block Diffusion (Arriola et al., 2025)**: **블록 확산 언어 모델**을 통해 **확산(non-AR)과 자기회귀(AR) 방법의 절충**을 시도한 연구입니다. 블록 단위로 시퀀스를 생성함으로써 **가변적인 길이의 텍스트 생성**을 지원하고, **KV-캐싱**(과거 블록의 키-값 메모리 활용) 및 **병렬 토큰 샘플링**으로 **추론 효율**을 개선했습니다 . 이 방식은 확산 모델의 **병렬화와 제어성** 이점을 살리면서도, AR 모델처럼 **임의 길이 텍스트**를 생성하는 유연성을 달성한 것으로 보고되었습니다.
- **SSD-LM 후속 및 기타 기법**: 이후에도 **Semi-AR 디퓨전**을 개선하는 다양한 기법들이 나왔습니다. 예를 들어, 불확실도에 따라 블록 크기를 가변적으로 조정하여 **속도와 품질을 균형**잡는 **적응형 병렬 디코딩** 기법 이나, 확산 LM의 **블록별 추론에 맞춘 학습(예: Blockwise SFT)**으로 훈련-추론 간 **불일치 문제**를 해결하는 연구  등이 보고되고 있습니다. 이는 모두 **블록 단위 생성**을 전제하고 확산 모델의 성능과 일관성을 높이기 위한 노력들입니다.





이처럼 **여러 문장을 한꺼번에 생성**하면서 **블록 간 순차성을 유지**하는 아이디어는 이미 **학계에서 주목**받고 있으며, 제안하신 특수 토큰을 활용한 문맥 요약 방식도 이러한 **계층적 생성**의 한 변형으로 볼 수 있습니다. 다만, **블록 요약 토큰에 가중치를 두어 문맥을 전달**하는 구체적인 방법은 기존 논문들에서 명시적으로 다루진 않은 새 시도로 보입니다. 비슷한 맥락으로, **긴 대화나 문서 생성 시 이전 내용을 요약하여 기억에 사용하는** 연구들(예: RecurrentGPT의 요약 메모리 기법)도 있는데, 이를 **확산 모델의 블록 맥락**에 접목한 형태로 이해할 수 있습니다.





## **블록 단위 Diffusion LLM의 기대되는 장점**





이러한 블록 생성 기반 Diffusion LLM 접근에는 다음과 같은 **장점과 가능성**이 기대됩니다:



- **병렬 생성으로 인한 효율 향상**: 각 블록의 N개 문장을 **Diffusion 과정으로 병렬 생성**하기 때문에, **토큰을 하나씩 순차 생성하는 GPT류 AR 모델보다 잠재적으로 디코딩 속도가 빠를 수** 있습니다 . 특히 블록 크기가 클 경우 한 블록을 확산 모델의 수십 단계 반복으로 생성하는 것이 AR의 수백 토큰 생성을 직렬로 하는 것보다 효율적일 가능성이 있습니다. 또한 **블록 내 병렬화** 덕분에 GPU 등을 활용한 연산 효율을 높일 수 있습니다.
- **양방향 문맥으로 인한 높은 일관성**: 블록 내부에서는 텍스트를 한꺼번에 생성하며 **문장들 간 양방향으로 상호 참조**할 수 있으므로, **국지적으로 더 일관되고 통합적인 표현**이 가능합니다  . 예를 들어 블록 내 후반부 문장이 앞부분 문장을 수정하거나 보완하는 것이 Diffusion 과정에서 이루어져, **문단 단위로 볼 때 앞뒤 문맥이 잘 어우러진 결과**가 나올 수 있습니다. 이는 전적으로 좌→우 진행으로 앞에 나온 오류를 되돌리기 어려운 AR 생성에 비해 **글 전체 완결성 측면에서 유리**할 수 있습니다.
- **전역 문맥 요약을 통한 장문 처리**: 각 블록에 삽입된 **특수 요약 토큰**은 **이전까지의 내용을 응축한 전역 컨텍스트** 역할을 합니다. 이를 활용해 다음 블록을 생성할 때는 **이전 블록들의 요약 벡터들만 참고**하면 되므로, 매우 긴 텍스트도 모든 세부 토큰을 참고하지 않고 **효율적으로 맥락 유지**가 가능합니다. 예를 들어, 10개 문장씩 5개의 블록으로 구성된 글이라면, 앞선 4개의 특수 토큰들만으로 이전 내용의 핵심을 조건으로 삼아 5번째 블록을 생성하는 식입니다. 이렇게 하면 **모델이 처리해야 할 컨텍스트 길이를 크게 줄이면서도** 중요한 내용은 이어받을 수 있어, **긴 문서 생성에 유리한 메모리 효율**을 얻습니다.
- **요약 토큰의 효과적 설계**: 제안된 대로 **블록의 후반부에 더 높은 가중치**를 부여해 특수 토큰을 학습시키면, 해당 블록의 **핵심 주제나 결론부 정보를 함축**할 가능성이 높습니다. 일반적으로 문단의 마지막 몇 문장은 해당 문단을 요약하거나 다음 전개를 암시하는 경우가 많습니다. 따라서 요약 토큰이 **후반 문장들을 특히 잘 반영**하도록 하면, 다음 블록 생성 시 **서사 흐름을 자연스럽게 이어가는 단서**를 제공할 수 있을 것입니다. 이는 단순히 모든 문장을 균등요약하는 것보다 **이야기의 맥락 연결에 유리한 정보**를 전달할 것으로 기대됩니다.
- **확산 모델의 유연한 제어와 생성 다양성**: 확산 기반 LLM은 AR 모델에 비해 **생성 과정 제어(control)와 표준 격차 감소** 등에 장점이 있습니다 . 예컨대 **클래시파이어 가이던스** 등을 통해 생성 문체나 속성을 제어하기 쉽고, 병렬 생성 특성상 **다양한 문장 구조**가 나타날 확률이 높습니다. 블록 단위 생성에서는 이러한 제어를 블록별로 적용할 수도 있어, 각 단락의 분위기나 스타일을 다르게 하는 등 **모듈식 제어**가 가능합니다 . 또한 필요에 따라 **임의 위치에 블록을 삽입하거나 수정(인필링)**도 Diffusion 모델이라면 비교적 수월하여, **AR로는 어려운 부분 편집이나 보강 생성**도 기대할 수 있습니다.
- **멀티모달 통합 용이성**: 본 접근법은 **멀티모달 생성**으로 확장하기에 자연스러운 구조를 갖습니다. 텍스트 생성 중간에 **이미지 블록**을 하나의 Diffusion 과정으로 생성하고, 그 이미지를 표현하는 특수 토큰(예: 이미지 임베딩 요약)을 다음 텍스트 블록의 조건으로 활용할 수 있습니다. 실제로 최근 연구들은 **텍스트-이미지-오디오를 하나의 통합 확산 프레임워크에서 생성**하는 시도를 보이고 있으며 , 제안된 방식처럼 **순차적으로 다양한 모달리티를 생성**하면서 **각 모달의 특징을 요약 벡터로 주고받는 구조**는 이러한 통합 생성에 적합합니다. 이를 통해 예를 들어 **줄거리 텍스트를 생성하다가 관련 이미지를 생성해 삽입하고 다시 텍스트를 이어가는** 형식의 **스토리텔링**이 가능해집니다. Diffusion 모델은 원래 이미지 생성에 강점이 있으므로, 텍스트 Diffusion LLM과 이미지 Diffusion을 번갈아 **동일 프레임워크에서 협업**시키는 것도 장점입니다.





以上의 이유들로, 블록 단위 Diffusion LLM은 **긴 텍스트를 빠르고 일관되게 생성**하고, **다양한 조건이나 모달리티를 유연하게 포함**할 수 있는 잠재력이 있습니다. 초기 연구 결과들도 이러한 접근이 **품질 면에서 AR 모델에 견줄 수 있음**을 보여주고 있어 , 향후 LLM 개발에 유망한 대안으로 평가됩니다.





## **예상되는 한계점과 도전 과제**





한편, 이러한 새로운 접근에는 극복해야 할 **잠재적 한계와 문제점**도 존재합니다:



- **추론 속도 및 효율성 이슈**: 블록 내부 병렬 생성을 하더라도, **Diffusion 모델 특성상 여러 반복 단계(예: 50~100 step)의 연산**이 필요하므로 토큰 하나당 한 번 추론하는 AR 모델보다 **속도가 느려질 수 있습니다** . 특히 블록 크기가 작거나 문장 수가 적으면, 오히려 AR이 빠를 수 있습니다. 즉, **병렬화 이득 vs. Diffusion 반복 오버헤드** 사이의 트레이드오프가 존재합니다. 최신 연구에서 diffusion LLM의 추론은 **양방향 어텐션 비용**과 **다수의 디노이징 스텝** 때문에 AR보다 느리다는 지적이 있으며 , 이를 개선하려고 **단계 감소 기법(DPM-Solver 등)**이나 **조기 종료(early stopping) 전략** 이 연구되고 있습니다. 따라서 제안 방식도 **속도 측면 최적화**가 중요합니다.
- **훈련 난이도 및 안정성**: 확산 기반 LLM을 블록 단위로 **훈련**시키는 것은 AR 대비 복잡합니다. 모델이 **블록별 생성 과정을 잘 학습**하도록 하려면, 일반적인 전체 문장 무작위 마스킹 훈련이 아니라 **블록 경계를 고려한 특수 학습 전략**이 필요합니다  . 예컨대 앞서 소개한 **Blockwise SFT**처럼, 매 훈련 스텝에 한 블록만 마스킹 복원하고 이전 블록은 고정, 이후는 가림으로써 **추론 시나리오와 유사하게 학습**시켜야 합니다  . 이러한 맞춤형 훈련이 구현되지 않으면, **훈련-추론 간 격차**로 인한 성능 저하(노이즈 prefix 문제, 미래 토큰 누출 등)가 발생할 수 있습니다 . 즉, **모델 학습 및 튜닝에 추가 복잡도**가 따른다는 한계가 있습니다.
- **요약 토큰의 정보 손실**: 이전 블록들의 내용을 요약 토큰 하나로만 전달하는 접근은 **상세 정보 손실**을 야기할 수 있습니다. 요약 벡터가 문맥의 핵심만 잡다 보면, 세부적인 인물/사물 정보나 앞서 제기된 복선 등을 **다음 블록이 놓칠 위험**이 있습니다. 특히 요약 토큰이 후반 문장 위주로 학습되면, 블록 앞부분의 중요한 내용이 반영되지 않을 수 있습니다. 이로 인해 **장문 생성 시 앞쪽 내용과 모순되거나 일부를 잊어버리는 문제**가 발생할 가능성이 있습니다. 완벽한 맥락 유지를 위해서는 경우에 따라 **이전 블록의 원문 토큰 일부**나 **다수의 요약 토큰**을 함께 조건으로 넣어야 할 수도 있는데, 이는 다시 **컨텍스트 길이 증가**와 트레이드오프로 작용합니다.
- **오류 전파 및 일관성 문제**: 블록 단위로 순차 생성하는 이상, **앞 블록에서 발생한 오류나 편향**이 특수 토큰을 통해 이후에 **영향을 미칠 수 있습니다**. AR 모델에서 한 번 잘못 생성한 토큰이 전체 문장 품질에 영향을 주듯, 블록 생성에서도 **한 블록의 불완전한 요약**이 다음 블록을 잘못 이끌 가능성이 있습니다. 예를 들어 앞 블록에서 어떤 설정을 잘못 기술했고 요약 토큰이 이를 압축하면, 다음 블록도 그 잘못된 설정을 사실로 이어받게 됩니다. 이런 **오류 누적**을 막으려면, 필요시 **블록 간 피드백 루프**나 **재검토 메커니즘**(예: 이전 블록을 다시 평가하여 요약 수정) 등이 요구될 수 있지만, 이는 현재 구조에서 쉽게 구현되진 않습니다.
- **블록 경계 설정의 어려움**: 제안에서는 블록을 N개 문장 등으로 정하지만, **고정된 블록 크기**가 항상 내용의 논리적 단위와 맞아떨어지지 않을 수 있습니다. 문단이 애매하게 쪼개지거나 한 블록 내에 **과도하게 많은 내용이 담기면**, 요약 토큰이 의미있게 맥락을 담기 어려워집니다. 반대로 블록이 너무 작으면 앞서 언급한 Diffusion 반복 비용 대비 이득이 줄어듭니다. 이상적인 블록 크기는 내용 전개의 **자연스러운 단위**여야 하나, 이를 모델이 스스로 결정하게 하는 것은 난제입니다. 일부 연구는 **불확실도**를 기준으로 블록 길이를 조정하는 시도를 했으나 , 완벽한 해결책은 아니며, 여전히 **블록 크기 및 경계 설정은 설계자가 튜닝**해야 하는 부분입니다.
- **멀티모달 통합 시의 복잡성**: 텍스트와 이미지를 교대로 생성하는 **멀티모달 블록 생성**은 흥미롭지만, 현실적으로 **두 종류의 Diffusion 모델의 긴밀한 협조**가 필요합니다. 예를 들어, 텍스트 블록의 요약 토큰이 이미지 생성을 제대로 안내하려면 **텍스트→이미지 조건 임베딩**의 품질이 좋아야 하고, 생성된 이미지를 다시 텍스트로 이어받을 때는 **이미지를 표현하는 임베딩**을 잘 뽑아내야 합니다. 현재 연구들에서도 **다중 모달 간 의미 일치**를 보장하는 것이 큰 도전이며 , 이를 위해 **계층적 크로스모달 어텐션**이나 **상호 조건부 생성** 등의 복잡한 메커니즘이 쓰입니다  . 제안 방식처럼 단순 요약 토큰 교환만으로는 **텍스트-이미지 간 섬세한 상호작용 부족**으로 **모달리티 불일치**가 생길 위험이 있습니다. 또한 멀티모달 생성은 단일 모달보다 **자원 소모가 크고** 최적화가 까다롭다는 점도 실제 적용에 장애 요소입니다 .
- **기존 AR LLM 대비 검증 부족**: 현재 GPT-4 같은 초거대 AR 언어모델들은 방대한 데이터로 학습되어 뛰어난 **지식력과 추론능력**을 보유합니다. 반면 Diffusion LLM 분야는 이제 막 수십억~몇십억 파라미터 수준에서 개념 검증이 된 단계로, **모델 규모나 학습 데이터 면에서 AR LLM에 비해 부족**한 경우가 많습니다 . 따라서 블록 Diffusion 방식이 구조적으로 유리하더라도, **동일한 지식 축적이나 추론 성능을 확보**하려면 AR 모델 수준의 거대하고 다양한 훈련이 필요합니다. 이는 단순 구조 문제는 아니지만, 현 시점에서 diffusion LLM이 AR LLM을 완전히 대체하기까지는 **실용적 성능 격차**를 줄이는 숙제가 남아 있습니다.





요약하면, **Diffusion 기반 블록 생성**은 혁신적인 장점을 제공하지만 동시에 **속도, 훈련, 정보손실, 모달결합** 등의 측면에서 해결해야 할 문제가 있습니다. 이러한 한계들은 현재 여러 연구에서 인식하고 개선하려 노력중이며  , 제안된 방향 역시 이러한 문제들을 염두에 두고 추가적인 보완이 이루어진다면 **긴 텍스트 생성의 새로운 패러다임**을 제시할 수 있을 것입니다.





## **결론 및 향후 전망**





Diffusion LLM을 블록 단위로 생성하는 접근은 **자연어 생성 분야의 효율-품질 딜레마를 해소**하려는 참신한 시도로 볼 수 있습니다. 이미 선행된 연구들(SSD-LM, Block Diffusion 등)을 통해 **블록별 병렬 생성의 실효성**이 입증되고 있으며, 이를 발전시켜 특수 요약 토큰을 활용한 문맥 전파, 그리고 나아가 **텍스트-이미지 혼합 생성**까지 고려하는 방향은 매우 흥미롭습니다. 이 방법은 **Transformer 기반 AR 생성의 한계를 보완**하면서, 동시에 **확산 모델의 강점**(유연한 제어, 병렬 처리)을 살릴 수 있다는 점에서 큰 잠재력이 있습니다.



물론 현재로서는 **모델 최적화, 일관성 유지, 멀티모달 간섭 해결** 등의 도전이 남아 있지만, 이는 **계속된 연구와 기술 발전으로 충분히 개선 가능한 영역**입니다. 예를 들어 **노이즈 스케줄 조정이나 샘플링 가이드 최적화**로 Diffusion 추론 속도를 높이고 , **대규모 데이터로 블록 Diffusion LLM을 프리트레인**하여 지식 수준을 높이는 한편, **대화 요약이나 메모리 네트워크 기법**을 도입해 요약 토큰의 정보 손실을 줄이는 등 다양한 보완이 가능할 것입니다. 멀티모달의 경우도, **공통 임베딩 공간에서의 contrastive 학습**이나 **교차 모달 주의(attention) 메커니즘**을 추가해 이미지와 텍스트 간 의미 공백을 줄이는 방향으로 발전할 수 있습니다 .



종합하면, Diffusion LLM의 블록 생성은 **장문 생성의 새로운 해법**으로서 관련 연구 흐름과 맞닿아 있으며, **속도와 문맥 활용 면에서 많은 기대**를 모읍니다. 동시에 현실적인 **제약과 한계도 분명**하므로, 이러한 점들을 고려한 면밀한 연구 개발이 필요합니다. 앞으로 더 정교한 모델 설계와 훈련 기법이 도입된다면, 제안하신 방향은 **고품질의 일관된 장편 텍스트와 멀티모달 콘텐츠 생성**까지 아우르는 **차세대 생성 AI 모델**로 이어질 전망입니다.



**참고 자료:** 블록 단위 Diffusion LLM 관련 주요 연구  , Diffusion LLM의 성능 및 한계 분석  , 멀티모달 확산 모델 프레임워크   등.

</div>

</details>
